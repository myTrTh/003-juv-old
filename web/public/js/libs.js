$(function(){$(".headsmile").on("click",function(){$(".smilepanel").slideToggle(200)})}),$(function(){$(".bbimg").on("click",function(){var t=$(this).attr("id"),e=$("textarea");if("post"==t)var n="post:",i="";else var n="["+t+"]",i="[/"+t+"]";var s=e[0].selectionStart,o=e[0].selectionEnd,a=e.val(),c=e.val().substr(s,o-s),l=n+c+i,u=e.val().length,r=a.substr(0,s),p=a.substr(o,u);e.val(r+l+p);e.val().length;e.focus(),0==c.length?e[0].setSelectionRange(s+n.length,s+n.length):e[0].setSelectionRange(s,o+n.length+i.length)})}),$(function(){$(".smiles").on("click",function(){var t=$(this).attr("id"),e=$("textarea"),n=t,i="",s=e[0].selectionStart,o=e[0].selectionEnd,a=e.val(),c=e.val().substr(s,o-s),l=n+c+i,u=e.val().length,r=a.substr(0,s),p=a.substr(o,u);e.val(r+l+p);e.val().length;e.focus(),0==c.length?e[0].setSelectionRange(s+n.length,s+n.length):e[0].setSelectionRange(s,o+n.length+i.length)})}),$(function(){$(".spoiler-name").on("click",function(){var t=$(this).parent();$(".spoiler-body:first",t).slideToggle(200),"+"==$(".sign",t).html()?$(".sign:first",t).html("−"):$(".sign:first",t).html("+")})}),$(function(){$(".tumbler").on("click",function(){var t=$(this).attr("id"),e=t.substr(0,1),n=t.substr(1);$("#u"+n).html(""),$("#d"+n).html("");var i="id="+escape(n)+"&sign="+escape(e);$.ajaxSetup({cache:!1}),$.ajax({url:"/guestbook/ranking",data:i,type:"POST",dataType:"json",success:function(t){0==t.sum?$("#r"+n).html("<span class='gray'>"+t.sum+"</span>"):t.sum>0?$("#r"+n).html("<span class='green'>+"+t.sum+"</span>"):t.sum<0&&$("#r"+n).html("<span class='red'>"+t.sum+"</span>"),0==t.author_sum?$(".us"+t.author_id).html("<span class='gray'>"+t.author_sum+"</span>"):t.author_sum>0?$(".us"+t.author_id).html("<span class='green'>+"+t.author_sum+"</span>"):t.author_sum<0&&$(".us"+t.author_id).html("<span class='red'>"+t.author_sum+"</span>"),$("#ru"+n).html(t.plus),$("#rd"+n).html(t.minus)}})})}),$(function(){$(".post-ranking").on("mouseenter mouseleave",function(){var t=$(this).parent();$(".rank-users",t).stop(!0,!1).slideToggle(400)})}),$(function(){$('div[id^="nach"]').on("mouseenter",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideDown(200)})}),$(function(){$('div[id^="nach"]').on("mouseleave",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideUp(200)})}),$(function(){$('div[id^="topnach"]').on("mouseenter",function(t){t.preventDefault(),$(".toptoolkit",this).stop(!0,!1).fadeIn(200)})}),$(function(){$('div[id^="topnach"]').on("mouseleave",function(t){t.preventDefault(),$(".toptoolkit",this).stop(!0,!1).fadeOut(200)})}),$(function(){$(".edit-post").on("click",function(){var t=$(this).attr("id"),e=t.substr(4),n=$("#message"+e),i=n.html().trim(),s=$("#hm"+e).text().trim();$("#hm"+e).html(i);var o=n.outerHeight(!0)+5;o<150&&(o=150),n.html("<textarea style='height: "+o+"px'>"+s+"</textarea><button id='update"+e+"' class='update button button-main'>Обновить</button><button id='cancel"+e+"' class='cancel button button-main'>Отмена</button>")})}),$(function(){$(document).on("click",".cancel",function(){var t=$(this).attr("id"),e=t.substr(6),n=$("#hm"+e).html().trim(),i=$("#message"+e+" > textarea").html().trim();$("#hm"+e).html(i),$("#message"+e).html(n)})}),$(function(){$(document).on("click",".update",function(){var t=$(this).attr("id"),e=t.substr(6),n=($("#post"+e),$("#message"+e+" > textarea").val()),i="id="+escape(e)+"&message="+encodeURIComponent(n);$.ajaxSetup({cache:!1}),$.ajax({url:"/guestbook/edit",data:i,type:"POST",dataType:"json",success:function(t){1==t.error?alert(t.text):($("#message"+e).html(t.text),$("#hm"+e).html(t.hide),0!=t.edit&&$("#post-edit"+e).html("...<i class='fa fa-edit'></i>"+t.edit))}})})}),$(function(){$(".quote").on("click",function(){var t=$(this).parent().parent().parent().parent().parent().parent().parent().attr("id"),e=t.substr(4),n=$(this).parent().parent().prev().children().next().children().children().html().trim(),i=$("#hd"+e).text().trim(),s=$("#hm"+e).text().trim(),o="[quote author="+n+" date="+i+" post="+e+"]\n"+s+"\n[/quote]\n\n",a=$("textarea"),c=a[0].selectionStart,l=a[0].selectionEnd,u=a.val(),r=u.substr(0,c),p=a.val().length,h=u.substr(l,p);return a.val(r+o+h),a.focus(),a[0].setSelectionRange(c+o.length,c+o.length),$("html, body").animate({scrollTop:320},500),!1})}),$(function(){$('div[id^="nach"]').on("mouseenter",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideDown(200)})}),$(function(){$('div[id^="nach"]').on("mouseleave",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideUp(200)})}),$(function(){$('div[id^="topnach"]').on("mouseenter",function(t){t.preventDefault(),$(".toptoolkit",this).stop(!0,!1).fadeIn(200)})}),$(function(){$("#navigation li").on("mouseenter",function(){$("ul",this).stop(!0,!1).slideDown(300)})}),$(function(){$("#navigation li").on("mouseleave",function(){$("ul",this).stop(!0,!1).slideUp(300)})}),$(function(){$('input[type="file"]',this).on("change",function(){var t=$(this);$(".in-file-text").html(t.val())})}),$(function(){$(".notification").on("click",function(){var t=$(this).attr("id"),e=$(this).prop("checked"),n="notification="+escape(t)+"&status="+escape(e);$.ajaxSetup({cache:!1}),$.ajax({url:"/notification/set",data:n,type:"POST",dataType:"json",success:function(t){}})})}),$(document).ready(function(){var t=$(".text_signature > input");if(t.length>0){var e=t.val().length;$("#numsymbols").html(e),$(".text_signature > input").keyup(function(){var t=$(this).val().length;$("#numsymbols").html(t)})}}),$(function(){$(".tournament-access").on("click",function(){var t=$(this).attr("id"),e=t.substr(4),n=$(this).prop("checked"),i=$("#trid").html();console.log(n);var s="user="+escape(e)+"&status="+escape(n)+"&tr="+escape(i);$.ajaxSetup({cache:!1}),$.ajax({url:"/access/set",data:s,type:"POST",dataType:"json",success:function(t){}})})}),$(function(){$(".player-scored").on("click",function(){var t=$("#howscored"),e=t.text();scored=["/public/images/scored/empty.png","/public/images/scored/goal.png","/public/images/scored/assist.png","/public/images/scored/yellow.png","/public/images/scored/red.png"];var n=$("img",this).attr("src");if(active=["empty","goal","assist","yellow","red"],e<=7)if(7==e&&"/public/images/scored/empty.png"==n)alert("Можно выбрать только 7 действий!");else{for(i=0;i<scored.length;i++)n==scored[i]&&(y=i);4==y?x=0:x=y+1,$("img",this).attr("src",scored[x]),$("input",this).attr("value",active[x]);var s=$('.player-scored > input[value!="empty"]').length;t.text(s)}})}),$(function(){$(".player-keeper").on("click",function(){scored=["/public/images/scored/emptykeeper.png","/public/images/scored/null.png","/public/images/scored/one.png","/public/images/scored/two.png","/public/images/scored/three.png"];var t=$("img",this).attr("src");for(active=["emptykeeper","null","one","two","three"],i=0;i<scored.length;i++)t==scored[i]&&(y=i);4==y?x=0:x=y+1,$("img",this).attr("src",scored[x]),$("input",this).attr("value",active[x])})}),$(function(){$("#add_option").on("click",function(){var t=$(".optionsgroup > input").length;$(".optionsgroup").append('<input type="text" name="option['+t+']">')})}),$(function(){$("#remove_option").on("click",function(){$(".optionsgroup > input").length>2?$(".optionsgroup input:last").remove():alert("Должно быть минимум два варианта ответа")})});