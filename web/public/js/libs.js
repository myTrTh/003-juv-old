var flatpickr_option={enableTime:!0,minDate:"today",locale:{firstDayOfWeek:1},time_24hr:!0};$(function(){flatpickr("input[id^=dtp]",flatpickr_option)}),$(function(){$(".users-panel-info").on("click",function(){var t=$(this).parent();$(".users-panel-body",t).slideToggle(300)})}),$(function(){$(".send_group").on("click",function(){var t=$(this).parent(),e=t.children('input[type="hidden"]').val(),n=t.attr("id"),s=n.substr(4),a=t.children("input:checked").val(),o="id="+escape(s)+"&role="+escape(a)+"&old="+escape(e);$.ajaxSetup({cache:!1}),$.ajax({url:"/ajax/adminpanel/setban",type:"POST",data:o,success:function(){t.children('input[type="hidden"]').val(a),"ROLE_BANNED_0"==a?($("#panel"+s).removeClass("background-warning"),$("#panel"+s).removeClass("background-danger")):"ROLE_BANNED_1"==a?($("#panel"+s).removeClass("background-danger"),$("#panel"+s).addClass("background-warning")):($("#panel"+s).removeClass("background-warning"),$("#panel"+s).addClass("background-danger"))}})})}),$(document).ready(function(){var t=$("input:checked").val();1==t?($(".schema1").css("display","block"),$(".schema2").css("display","block"),$(".schema3").css("display","none")):2==t?($(".schema1").css("display","block"),$(".schema2").css("display","none"),$(".schema3").css("display","none")):($(".schema1").css("display","block"),$(".schema2").css("display","block"),$(".schema3").css("display","block"))}),$(function(){$(document).on("focus",".radios",function(){var t=$(this).val();console.log(t),1==t?($(".schema1").show(500),$(".schema2").show(500),$(".schema3").hide(500)):2==t?($(".schema1").show(500),$(".schema2").hide(500),$(".schema3").hide(500)):($(".schema1").show(500),$(".schema2").show(500),$(".schema3").show(500))})}),$(document).ready(function(){var t=$(".tournament-user div").length;$(".allow").html(t)}),$(function(){$(document).on("click",".preteam",function(){var t=$(this),e=t.attr("id"),n=e.substr(1);t.removeClass("preteam"),t.addClass("team");var s=$("#schema").html(),a=$(".tournament-user div").length;if(1==s){var o=$(".tournament-user");o.append(t)}else if(2==s){var o=$(".tournament-user");o.append(t),a%2==0?o.append(" - "):o.append("<br>")}else if(3==s){var i=$("#groups").html(),o=$(".tournament-user");if(a%i==0){var c;0==a&&(c="A"),4==a&&(c="B"),8==a&&(c="C"),12==a&&(c="D"),16==a&&(c="E"),20==a&&(c="F"),24==a&&(c="G"),26==a&&(c="H"),o.append("<br>ГРУППА "+c+"<br>")}o.append(t)}$(".form-hidden").append('<input type="hidden" id="form_user_'+n+'" name="form[user]['+n+']" value="'+n+'" class="form-control" />');var r=$(".tournament-user div").length;$(".allow").html(r);var l=$(".all").html(),u=$(".but");0==$("#groups").html()?l==r?(console.log("all "+l+" allow "+r),u.show()):u.hide():2==r||4==r||8==r||16==r||32==r||64==r||128==r||256==r?u.show():u.hide()})}),$(function(){$("#add_score").on("click",function(t){t.stopPropagation();var e=$(".scoregroup"),n=$(".score").last(),s=$(".scoregroup > .score").length,a=n.clone();$("input",a).prop("id","dtpbefore"+s),a.appendTo(e),a.find("input[id^=dtp]").flatpickr(flatpickr_option)})}),$(function(){$("#remove_score").on("click",function(){$(".scoregroup > .score").length>1?$(".score:last").remove():alert("Должен быть минимум один матч")})}),$(function(){$(".headsmile").on("click",function(){$(".smilepanel").slideToggle(200)})}),$(function(){$(".bbimg").on("click",function(){var t=$(this).attr("id"),e=$("textarea");if("post"==t)var n="post:",s="";else var n="["+t+"]",s="[/"+t+"]";var a=e[0].selectionStart,o=e[0].selectionEnd,i=e.val(),c=e.val().substr(a,o-a),r=n+c+s,l=e.val().length,u=i.substr(0,a),p=i.substr(o,l);e.val(u+r+p);e.val().length;e.focus(),0==c.length?e[0].setSelectionRange(a+n.length,a+n.length):e[0].setSelectionRange(a,o+n.length+s.length)})}),$(function(){$(".smiles").on("click",function(){var t=$(this).attr("id"),e=$("textarea"),n=t,s="";console.log(n);var a=e[0].selectionStart,o=e[0].selectionEnd,i=e.val(),c=e.val().substr(a,o-a),r=n+c+s,l=e.val().length,u=i.substr(0,a),p=i.substr(o,l);e.val(u+r+p);e.val().length;e.focus(),0==c.length?e[0].setSelectionRange(a+n.length,a+n.length):e[0].setSelectionRange(a,o+n.length+s.length)})}),$(function(){$(".spoiler-name").on("click",function(){var t=$(this).parent();$(".spoiler-body:first",t).slideToggle(200),"+"==$(".sign",t).html()?$(".sign:first",t).html("−"):$(".sign:first",t).html("+")})}),$(function(){$(".tumbler").on("click",function(){var t=$(this).attr("id"),e=t.substr(0,1),n=t.substr(1);$("#u"+n).html(""),$("#d"+n).html("");var s="id="+escape(n)+"&sign="+escape(e);$.ajaxSetup({cache:!1}),$.ajax({url:"/guestbook/ranking",data:s,type:"POST",dataType:"json",success:function(t){0==t.sum?$("#r"+n).html("<span class='gray'>"+t.sum+"</span>"):t.sum>0?$("#r"+n).html("<span class='green'>+"+t.sum+"</span>"):t.sum<0&&$("#r"+n).html("<span class='red'>"+t.sum+"</span>"),0==t.author_sum?$(".us"+t.author_id).html("<span class='gray'>"+t.author_sum+"</span>"):t.author_sum>0?$(".us"+t.author_id).html("<span class='green'>+"+t.author_sum+"</span>"):t.author_sum<0&&$(".us"+t.author_id).html("<span class='red'>"+t.author_sum+"</span>"),$("#ru"+n).html(t.plus),$("#rd"+n).html(t.minus)}})})}),$(function(){$(".post-ranking").on("mouseenter mouseleave",function(){var t=$(this).parent();$(".rank-users",t).stop(!0,!1).slideToggle(400)})}),$(function(){$('div[id^="nach"]').on("mouseenter",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideDown(200)})}),$(function(){$('div[id^="nach"]').on("mouseleave",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideUp(200)})}),$(function(){$('div[id^="topnach"]').on("mouseenter",function(t){t.preventDefault(),$(".toptoolkit",this).stop(!0,!1).fadeIn(200)})}),$(function(){$('div[id^="topnach"]').on("mouseleave",function(t){t.preventDefault(),$(".toptoolkit",this).stop(!0,!1).fadeOut(200)})}),$(function(){$(".edit-post").on("click",function(){var t=$(this).attr("id"),e=t.substr(4),n=$("#message"+e),s=n.html().trim(),a=$("#hm"+e).text().trim();$("#hm"+e).html(s);var o=n.outerHeight(!0)+5;o<150&&(o=150),n.html("<textarea style='height: "+o+"px'>"+a+"</textarea><button id='update"+e+"' class='update button button-main'>Обновить</button><button id='cancel"+e+"' class='cancel button button-main'>Отмена</button>")})}),$(function(){$(document).on("click",".cancel",function(){var t=$(this).attr("id"),e=t.substr(6),n=$("#hm"+e).html().trim(),s=$("#message"+e+" > textarea").html().trim();$("#hm"+e).html(s),$("#message"+e).html(n)})}),$(function(){$(document).on("click",".update",function(){var t=$(this).attr("id"),e=t.substr(6),n=($("#post"+e),$("#message"+e+" > textarea").val()),s="id="+escape(e)+"&message="+encodeURIComponent(n);$.ajaxSetup({cache:!1}),$.ajax({url:"/guestbook/edit",data:s,type:"POST",dataType:"json",success:function(t){1==t.error?alert(t.text):($("#message"+e).html(t.text),$("#hm"+e).html(t.hide),0!=t.edit&&$("#post-edit"+e).html("...<i class='fa fa-edit'></i>"+t.edit))}})})}),$(function(){$(".quote").on("click",function(){var t=$(this).parent().parent().parent().parent().attr("id"),e=t.substr(4),n=$(this).parent().parent().prev().children().next().children().children().html().trim(),s=$("#hd"+e).text().trim(),a=$("#hm"+e).text().trim(),o="[quote author="+n+" date="+s+" post="+e+"]\n"+a+"\n[/quote]\n\n",i=$("textarea"),c=i[0].selectionStart,r=i[0].selectionEnd,l=i.val(),u=l.substr(0,c),p=i.val().length,d=l.substr(r,p);return i.val(u+o+d),i.focus(),i[0].setSelectionRange(c+o.length,c+o.length),$("html, body").animate({scrollTop:400},500),!1})}),$(function(){$('div[id^="nach"]').on("mouseenter",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideDown(200)})}),$(function(){$('div[id^="nach"]').on("mouseleave",function(t){t.preventDefault(),$(".toolkit",this).stop(!0,!1).slideUp(200)})}),$(function(){$('div[id^="topnach"]').on("mouseenter",function(t){t.preventDefault(),$(".toptoolkit",this).stop(!0,!1).fadeIn(200)})}),$(function(){$("#navigation li").on("mouseenter",function(){$("ul",this).stop(!0,!1).slideDown(300)})}),$(function(){$("#navigation li").on("mouseleave",function(){$("ul",this).stop(!0,!1).slideUp(300)})}),$(function(){$('input[type="file"]',this).on("change",function(){var t=$(this);$(".in-file-text").html(t.val())})}),$(function(){$(".notification").on("click",function(){var t=$(this).attr("id"),e=$(this).prop("checked"),n="notification="+escape(t)+"&status="+escape(e);$.ajaxSetup({cache:!1}),$.ajax({url:"/notification/set",data:n,type:"POST",dataType:"json",success:function(t){}})})}),$(function(){$(".tournament-access").on("click",function(){var t=$(this).attr("id"),e=t.substr(4),n=$(this).prop("checked"),s=$("#trid").html();console.log(n);var a="user="+escape(e)+"&status="+escape(n)+"&tr="+escape(s);$.ajaxSetup({cache:!1}),$.ajax({url:"/access/set",data:a,type:"POST",dataType:"json",success:function(t){}})})}),$(function(){$(".player-scored").on("click",function(){var t=$("#howscored"),e=t.text();scored=["/public/images/scored/empty.png","/public/images/scored/goal.png","/public/images/scored/assist.png","/public/images/scored/yellow.png","/public/images/scored/red.png"];var n=$("img",this).attr("src");if(active=["empty","goal","assist","yellow","red"],e<=7)if(7==e&&"/public/images/scored/empty.png"==n)alert("Можно выбрать только 7 действий!");else{for(i=0;i<scored.length;i++)n==scored[i]&&(y=i);4==y?x=0:x=y+1,$("img",this).attr("src",scored[x]),$("input",this).attr("value",active[x]);var s=$('.player-scored > input[value!="empty"]').length;t.text(s)}})}),$(function(){$(".player-keeper").on("click",function(){scored=["/public/images/scored/emptykeeper.png","/public/images/scored/null.png","/public/images/scored/one.png","/public/images/scored/two.png","/public/images/scored/three.png"];var t=$("img",this).attr("src");for(active=["emptykeeper","null","one","two","three"],i=0;i<scored.length;i++)t==scored[i]&&(y=i);4==y?x=0:x=y+1,$("img",this).attr("src",scored[x]),$("input",this).attr("value",active[x])})}),$(function(){$("#add_option").on("click",function(){var t=$(".optionsgroup > input").length;$(".optionsgroup").append('<input type="text" name="option['+t+']">')})}),$(function(){$("#remove_option").on("click",function(){$(".optionsgroup > input").length>2?$(".optionsgroup input:last").remove():alert("Должно быть минимум два варианта ответа")})});